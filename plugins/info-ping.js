import speed from 'performance-now'
import { exec } from 'child_process'

let handler = async (m, { conn }) => {
  let timestamp = speed()
  let sentMsg = await conn.reply(m.chat, 'ğŸ’  Calculando la energÃ­a Miku... ğŸ’ \nâ³ Espera un momento...', m)
  let latency = speed() - timestamp

  exec(`neofetch --stdout`, (error, stdout, stderr) => {
    let child = stdout.toString("utf-8");
    let ssd = child.replace(/Memory:/, "ğŸŒˆ Ram:");

    // ğŸ€ Encabezados temÃ¡ticos aleatorios (30)
    const encabezados = [
      'ğŸ’™ ğ“œğ“²ğ“´ğ“¾ ğ“Ÿğ“²ğ“·ğ“° ğ“¢ğ“®ğ“·ğ“¼ğ“¸ğ“» ğŸ’™',
      'ğŸ§ ğ˜ğ˜¢ğ˜µğ˜´ğ˜¶ğ˜¯ğ˜¦ ğ˜—ğ˜ªğ˜¯ğ˜¨ ğ˜šğ˜ºğ˜´ğ˜µğ˜¦ğ˜® ğŸ§',
      'âœ¨ Miku estÃ¡ midiendo tu velocidad âœ¨',
      'ğŸ”¹ Vocaloid Ping Machine ğŸ”¹',
      'ğŸŒ¸ Pink Latency! ğŸŒ¸',
      'ğŸ’« Latido digital de Miku ğŸ’«',
      'ğŸ¶ Respuesta Vocaloid ğŸ¶',
      'ğŸ€ Ping estilo Idol ğŸ€',
      'ğŸª Ecos de Hatsune ğŸª',
      'ğŸ“¡ Miku Connection ğŸ“¡',
      'ğŸ§ Ping dulce y suave ğŸ§',
      'â˜ï¸ Medidor de cielo azul â˜ï¸',
      'ğŸŒˆ Banda ancha de colores ğŸŒˆ',
      'ğŸŒ€ Girando en bytes con Miku ğŸŒ€',
      'ğŸ“€ Audio Ping Analyzer ğŸ“€',
      'ğŸ¡ Dango Ping ğŸ¡',
      'ğŸ©· AnÃ¡lisis digital rosado ğŸ©·',
      'ğŸ¼ Miku Midori Scanner ğŸ¼',
      'ğŸŒº Vocal Beat Ping ğŸŒº',
      'ğŸ¦‹ Ping EtÃ©reo Miku ğŸ¦‹',
      'ğŸ§ƒ Juguito de velocidad ğŸ§ƒ',
      'ğŸ“ˆ MediciÃ³n exacta al estilo Miku ğŸ“ˆ',
      'ğŸ™ï¸ Ping con armÃ³nicos ğŸ™ï¸',
      'ğŸ§  Modo diagnÃ³stico Miku ğŸ§ ',
      'ğŸ’¾ Bits saltando felices ğŸ’¾',
      'ğŸ¬ Caramelo de latencia ğŸ¬',
      'ğŸ”Š Ping ultra claro ğŸ”Š',
      'ğŸ¤ Eco Vocaloid ğŸ¤',
      'ğŸ”® Cristal de ping ğŸ”®',
      'ğŸ’– Latencia mÃ¡gica ğŸ’–'
    ]

    // ğŸ’  Bordes decorativos aleatorios (30)
    const bordes = [
      ['â•­â”€ğŸŒŸâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ğŸŒŸâ”€â•®', 'â•°â”€ğŸŒŸâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ğŸŒŸâ”€â•¯'],
      ['â•­â•â•â•ğŸ’™â•â•â•âŠ¹âŠ±âœ¿âŠ°âŠ¹â•â•â•ğŸ’™â•â•â•â•®', 'â•°â•â•â•ğŸ’™â•â•â•âŠ¹âŠ±âœ¿âŠ°âŠ¹â•â•â•ğŸ’™â•â•â•â•¯'],
      ['â•”â•â•â•â•â•ğŸ§â•â•â•â•â•â•—', 'â•šâ•â•â•â•â•ğŸ§â•â•â•â•â•â•'],
      ['â•­â”â”â”âœ§ğŸ€âœ§â”â”â”â•®', 'â•°â”â”â”âœ§ğŸ€âœ§â”â”â”â•¯'],
      ['â•”â”€â”€â”€â”€â”€â€â”€â”€â”€â”€â”€â•—', 'â•šâ”€â”€â”€â”€â”€â€â”€â”€â”€â”€â”€â•'],
      ['â˜…å½¡â”â”â”â”â”ğŸªâ”â”â”â”â”å½¡â˜…', 'â˜…å½¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”å½¡â˜…'],
      ['â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®', 'â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯'],
      ['ğŸŒ€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸŒ€', 'ğŸŒ€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸŒ€'],
      ['â•­ğŸŒˆâ”â”â”âŠ°âœ¿âŠ±â”â”â”ğŸŒˆâ•®', 'â•°ğŸŒˆâ”â”â”âŠ°âœ¿âŠ±â”â”â”ğŸŒˆâ•¯'],
      ['âœ¦â•â•â•â•â•â•âŠ¹âŠ±âœ¿âŠ°âŠ¹â•â•â•â•â•â•âœ¦', 'âœ¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•âœ¦'],
      ['âœ¿â”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€', 'â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¾Ÿï½¡ï½¥*.ï¾Ÿâ˜†â”âœ¿'],
      ['â•­â”â”â”â”â”â”â™¡â™¡â™¡â”â”â”â”â”â”â•®', 'â•°â”â”â”â”â”â”â™¡â™¡â™¡â”â”â”â”â”â”â•¯'],
      ['ğŸŒ¸ï½¥*:.ï½¡.âœ¿.ï½¡.:*ï½¥ğŸŒ¸', 'ğŸŒ¸ï½¥*:.ï½¡.âœ¿.ï½¡.:*ï½¥ğŸŒ¸'],
      ['â•”â•â•â•ğŸŒºâ•â•â•â•—', 'â•šâ•â•â•ğŸŒºâ•â•â•â•'],
      ['ğŸ©·â•â”€â”€â”€â”€â”€â”€â”€â•ğŸ©·', 'ğŸ©·â•â”€â”€â”€â”€â”€â”€â”€â•ğŸ©·'],
      ['â•­â”â”â”ğŸ”·â”â”â”â•®', 'â•°â”â”â”ğŸ”·â”â”â”â•¯'],
      ['ğŸ¡â”â”â•â”â•â”â•â”â”ğŸ¡', 'ğŸ¡â”â”â•â”â•â”â•â”â”ğŸ¡'],
      ['â•­ğŸŒ¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®', 'â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ğŸŒ¼â•¯'],
      ['â•­â•â•â•â•â•â•â•ğŸ“€â•â•â•â•â•â•â•â•®', 'â•°â•â•â•â•â•â•â•ğŸ“€â•â•â•â•â•â•â•â•¯'],
      ['ğŸµâ‹†ï½¡Ëšâ˜ï¸Ëšï½¡â‹†ï½¡', 'ï½¡â‹†Ëšâ˜ï¸Ëšï½¡â‹†ğŸµ'],
      ['â•”â•â•â•â•â•ğŸ”Šâ•â•â•â•â•â•—', 'â•šâ•â•â•â•â•ğŸ”Šâ•â•â•â•â•â•'],
      ['â•­â¤ğŸ™ï¸â”â”â”ğŸ§â¤', 'â•°â¤ğŸ§â”â”â”ğŸ™ï¸â¤'],
      ['â•­â”â”â­‘ï½¡Ëšâ˜½Ëšï½¡â­‘â”â”â•®', 'â•°â”â”â­‘ï½¡Ëšâ˜¾Ëšï½¡â­‘â”â”â•¯'],
      ['â”Œâ”€â”€â”€â”€â”€âŠ±â™¡âŠ°â”€â”€â”€â”€â”€â”', 'â””â”€â”€â”€â”€â”€âŠ±â™¡âŠ°â”€â”€â”€â”€â”€â”˜'],
      ['ğŸŒ¼â”â”â”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿâ”â”â”ğŸŒ¼', 'ğŸŒ¼â”â”â”â˜†ï¾Ÿ.*ï½¥ï½¡ï¾Ÿâ”â”â”ğŸŒ¼'],
      ['â•­â”€â¤ğŸŒ¸â”â”ğŸŒŸâ”â”ğŸŒ¸â¤â”€â•®', 'â•°â”€â¤ğŸŒ¸â”â”ğŸŒŸâ”â”ğŸŒ¸â¤â”€â•¯'],
      ['â•­âŠ°ğŸ’ âŠ±â”€â”€â”€âŠ°ğŸ’ âŠ±â•®', 'â•°âŠ°ğŸ’ âŠ±â”€â”€â”€âŠ°ğŸ’ âŠ±â•¯'],
      ['â•­ğŸŒŸğŸŒŸğŸŒŸâ•®', 'â•°ğŸŒŸğŸŒŸğŸŒŸâ•¯'],
      ['ğŸŒˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”ğŸŒˆ', 'ğŸŒˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”ğŸŒˆ'],
      ['â•­ğŸŒºâ”€â”€â”€Ping Timeâ”€â”€â”€ğŸŒºâ•®', 'â•°ğŸŒºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ğŸŒºâ•¯'],
    ]

    let header = encabezados[Math.floor(Math.random() * encabezados.length)]
    let borde = bordes[Math.floor(Math.random() * bordes.length)]

    let result = `
${borde[0]}
ğŸ’« ${header} ğŸ’«

ğŸ“¶ *Â¡Pong recibido!*
ğŸ”¹ *Tiempo de respuesta:* ${latency.toFixed(4).split(".")[0]}ms

${ssd}
${borde[1]}
`.trim()

    conn.sendMessage(m.chat, { text: result, edit: sentMsg.key }, { quoted: m })
  })
}

handler.help = ['ping']
handler.tags = ['info']
handler.command = ['ping', 'p']

export default handler
